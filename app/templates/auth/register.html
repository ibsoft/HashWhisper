{% extends 'base.html' %}
{% block content %}
<div class="landing-hero auth-hero">
  <div class="landing-hero__glow"></div>
  <div class="landing-hero__particles" aria-hidden="true">
    {% for _ in range(4) %}
      <span></span>
    {% endfor %}
  </div>
  <div class="row justify-content-center align-items-center auth-page-row">
    <div class="col-lg-7">
      <div class="card card-glass p-4 landing-card">
      <div class="text-center mb-2">
        <img src="{{ url_for('static', filename='img/logo.png') }}" alt="{{ config.APP_TITLE }}" class="register-logo landing-logo">
      </div>
      <h2 class="mb-3 text-center">{{ _('Create account') }}</h2>
      <form method="post" novalidate>
        {{ form.hidden_tag() }}
        {% if form.errors %}
        <div class="alert alert-danger">
          {{ _('Please fix the issues below:') }}
          <ul class="mb-0 mt-2">
            {% for field, errors in form.errors.items() %}
              {% for error in errors %}
                <li>{{ error }}</li>
              {% endfor %}
            {% endfor %}
          </ul>
        </div>
        {% endif %}
        <div class="mb-3">
          {{ form.username.label(class='form-label') }}
          {{ form.username(class='form-control ' + ('is-invalid' if form.username.errors else ''), autocomplete='username') }}
          {% if form.username.errors %}
            <div class="invalid-feedback">{{ form.username.errors[0] }}</div>
          {% endif %}
        </div>
        <div class="mb-3">
          {{ form.email.label(class='form-label') }}
          {{ form.email(class='form-control ' + ('is-invalid' if form.email.errors else ''), autocomplete='email') }}
          {% if form.email.errors %}
            <div class="invalid-feedback">{{ form.email.errors[0] }}</div>
          {% endif %}
        </div>
        <div class="mb-3">
          {{ form.password.label(class='form-label') }}
          {{ form.password(class='form-control ' + ('is-invalid' if form.password.errors else ''), autocomplete='new-password') }}
          {% if form.password.errors %}
            <div class="invalid-feedback">{{ form.password.errors[0] }}</div>
          {% endif %}
        </div>
        <div class="mb-3">
          {{ form.confirm.label(class='form-label') }}
          {{ form.confirm(class='form-control ' + ('is-invalid' if form.confirm.errors else ''), autocomplete='new-password') }}
          {% if form.confirm.errors %}
            <div class="invalid-feedback">{{ form.confirm.errors[0] }}</div>
          {% endif %}
        </div>
        <button class="btn btn-soft w-100" type="submit">{{ form.submit.label.text }}</button>
      </form>
      <p class="mt-3 text-muted">{{ _('Already have an account?') }} <a href="{{ url_for('auth.login') }}">{{ _('Sign in') }}</a></p>
      {% if require_totp %}
      <div class="alert alert-info mt-3">{{ _('Strong password + TOTP are mandatory.') }}</div>
      {% elif totp_disabled %}
      <div class="alert alert-secondary mt-3">{{ _('TOTP has been disabled by configuration.') }}</div>
      {% endif %}
    </div>
  </div>
</div>
</div>
{% endblock %}
